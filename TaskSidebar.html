<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
      /* Apple Design System */
      :root {
        --apple-blue: #007AFF;
        --apple-blue-hover: #0051D5;
        --apple-green: #34C759;
        --apple-red: #FF3B30;
        --apple-gray-1: #F5F5F7;
        --apple-gray-2: #E5E5E7;
        --apple-gray-3: #86868B;
        --apple-gray-6: #1D1D1F;
        --spacing-sm: 8px;
        --spacing-md: 16px;
        --spacing-lg: 20px;
        --font-size-sm: 13px;
        --font-size-md: 15px;
        --font-size-lg: 18px;
        --radius-md: 10px;
        --radius-lg: 14px;
        --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.06);
        --shadow-md: 0 4px 12px rgba(0, 0, 0, 0.08);
        --transition-fast: 150ms cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      * {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }
      
      body {
        font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'Helvetica Neue', Arial, sans-serif;
        font-size: var(--font-size-md);
        line-height: 1.5;
        color: var(--apple-gray-6);
        padding: var(--spacing-lg);
        -webkit-font-smoothing: antialiased;
      }
      
      h2 {
        font-size: var(--font-size-lg);
        font-weight: 700;
        margin-bottom: var(--spacing-lg);
        letter-spacing: -0.02em;
        color: var(--apple-gray-6);
      }
      
      label {
        display: block;
        font-size: var(--font-size-sm);
        font-weight: 500;
        color: var(--apple-gray-6);
        margin-bottom: 4px;
        margin-top: var(--spacing-md);
        letter-spacing: -0.01em;
      }
      
      input[type="text"],
      input[type="number"],
      input[type="date"],
      textarea,
      select {
        width: 100%;
        padding: var(--spacing-sm) var(--spacing-md);
        font-size: var(--font-size-md);
        font-family: inherit;
        color: var(--apple-gray-6);
        background-color: var(--apple-gray-1);
        border: 1px solid transparent;
        border-radius: var(--radius-md);
        transition: all var(--transition-fast);
        outline: none;
        margin-bottom: var(--spacing-sm);
      }
      
      input:focus,
      textarea:focus,
      select:focus {
        background-color: #fff;
        border-color: var(--apple-blue);
        box-shadow: 0 0 0 3px rgba(0, 122, 255, 0.1);
      }
      
      input::placeholder,
      textarea::placeholder {
        color: var(--apple-gray-3);
      }
      
      select {
        appearance: none;
        background-image: url("data:image/svg+xml,%3Csvg width='12' height='8' viewBox='0 0 12 8' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1.5L6 6.5L11 1.5' stroke='%2386868B' stroke-width='1.5' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E");
        background-repeat: no-repeat;
        background-position: right var(--spacing-md) center;
        padding-right: 32px;
        cursor: pointer;
      }
      
      textarea {
        resize: vertical;
        min-height: 70px;
      }
      
      button {
        width: 100%;
        padding: var(--spacing-sm) var(--spacing-lg);
        font-size: var(--font-size-md);
        font-weight: 500;
        font-family: inherit;
        color: #fff;
        background-color: var(--apple-blue);
        border: none;
        border-radius: var(--radius-lg);
        cursor: pointer;
        transition: all var(--transition-fast);
        box-shadow: var(--shadow-sm);
        letter-spacing: -0.01em;
        outline: none;
        margin-top: var(--spacing-md);
      }
      
      button:hover {
        background-color: var(--apple-blue-hover);
        box-shadow: var(--shadow-md);
        transform: translateY(-1px);
      }
      
      button:active {
        transform: translateY(0);
      }
      
      button:disabled {
        opacity: 0.5;
        cursor: not-allowed;
        transform: none;
      }
      
      .message {
        padding: var(--spacing-md);
        border-radius: var(--radius-md);
        margin-top: var(--spacing-md);
        font-size: var(--font-size-sm);
        font-weight: 500;
        animation: slideIn 250ms cubic-bezier(0.4, 0, 0.2, 1);
      }
      
      .message-success {
        background-color: rgba(52, 199, 89, 0.1);
        color: var(--apple-green);
        border: 1px solid rgba(52, 199, 89, 0.2);
      }
      
      .message-error {
        background-color: rgba(255, 59, 48, 0.1);
        color: var(--apple-red);
        border: 1px solid rgba(255, 59, 48, 0.2);
      }
      
      @keyframes slideIn {
        from {
          opacity: 0;
          transform: translateY(-8px);
        }
        to {
          opacity: 1;
          transform: translateY(0);
        }
      }
    </style>
  </head>
  <body>
    <h2>✨ Add New Task</h2>
    <label for="task-title">Task Title</label>
    <input type="text" id="task-title" required>
    <label for="task-desc">Task Description</label>
    <textarea id="task-desc" rows="3"></textarea>
    <label for="task-priority">Task Priority</label>
    <input type="number" id="task-priority" min="1" required>
    <label for="task-label">Task Label</label>
    <select id="task-label"></select>
    <label for="task-pillar">Task Pillar</label>
    <select id="task-pillar"></select>
    <label for="task-who">Assigned To</label>
    <select id="task-who"></select>
    <label for="task-due">Task Due Date</label>
    <input type="date" id="task-due">
    <label for="task-status">Task Status</label>
    <select id="task-status"></select>
    <button onclick="submitTask()">Submit</button>

    <script>
      // Load dropdown options from server
      google.script.run.withSuccessHandler(populateDropdowns).getDropdownOptions();

      function populateDropdowns(options) {
        const { statuses, labels, pillars, people } = options;
        const statusSelect = document.getElementById('task-status');
        statuses.forEach(s => {
          const opt = document.createElement('option');
          opt.value = opt.textContent = s;
          statusSelect.appendChild(opt);
        });
        const labelSelect = document.getElementById('task-label');
        labels.forEach(l => {
          const opt = document.createElement('option');
          opt.value = opt.textContent = l;
          labelSelect.appendChild(opt);
        });
        const pillarSelect = document.getElementById('task-pillar');
        pillars.forEach(p => {
          const opt = document.createElement('option');
          opt.value = opt.textContent = p;
          pillarSelect.appendChild(opt);
        });
        const whoSelect = document.getElementById('task-who');
        people.forEach(p => {
          const opt = document.createElement('option');
          opt.value = opt.textContent = p;
          whoSelect.appendChild(opt);
        });
      }

      function submitTask() {
        const task = {
          title: document.getElementById('task-title').value,
          description: document.getElementById('task-desc').value,
          priority: parseInt(document.getElementById('task-priority').value),
          label: document.getElementById('task-label').value,
          pillar: document.getElementById('task-pillar').value,
          who: document.getElementById('task-who').value,
          dueDate: document.getElementById('task-due').value,
          status: document.getElementById('task-status').value
        };
        google.script.run
        .withSuccessHandler(() => {
          // Reset form fields after successful submission
          document.getElementById('task-title').value = '';
          document.getElementById('task-desc').value = '';
          document.getElementById('task-priority').value = '';
          document.getElementById('task-due').value = '';
          alert('✅ Task added successfully!');
        })
        .withFailureHandler((error) => {
          alert('❌ Error adding task: ' + error.message);
        })
        .addTask(task);
      }

    </script>

  </body>

</html>
